ğŸ–•æ¬¢è¿å…³æ³¨æˆ‘çš„å…¬ä¼—å·â€œå½¤å“¥è¯»æºç â€ï¼ŒæŸ¥çœ‹æ›´å¤šæºç ç³»åˆ—æ–‡ç« , ä¸å½¤å“¥ä¸€èµ·ç•…æ¸¸æºç çš„æµ·æ´‹ã€‚ 

ï¼ˆæ‰‹æœºæ¨ªå±çœ‹æºç æ›´æ–¹ä¾¿ï¼‰

---

ä½ çŸ¥é“å‡ ç§å®ä¾‹åŒ–ä¸€ä¸ªç±»çš„æ–¹å¼ï¼Ÿ

newï¼Ÿåå°„ï¼Ÿè¿˜æœ‰å‘¢ï¼Ÿ

ç¬”è€…æ€»ç»“äº†ä¸€ä¸‹å¤§æ¦‚æœ‰ä»¥ä¸‹å…­ç§æ–¹å¼ï¼š

ï¼ˆ1ï¼‰é€šè¿‡æ„é€ æ–¹æ³•å®ä¾‹åŒ–ä¸€ä¸ªç±»ï¼›

ï¼ˆ2ï¼‰é€šè¿‡Classå®ä¾‹åŒ–ä¸€ä¸ªç±»ï¼›

ï¼ˆ3ï¼‰é€šè¿‡åå°„å®ä¾‹åŒ–ä¸€ä¸ªç±»ï¼›

ï¼ˆ4ï¼‰é€šè¿‡å…‹éš†å®ä¾‹åŒ–ä¸€ä¸ªç±»ï¼›

ï¼ˆ5ï¼‰é€šè¿‡ååºåˆ—åŒ–å®ä¾‹åŒ–ä¸€ä¸ªç±»ï¼›

ï¼ˆ6ï¼‰é€šè¿‡Unsafeå®ä¾‹åŒ–ä¸€ä¸ªç±»ï¼›

Let us ç›´æ¥ä¸Šä»£ç ï¼š

```java
public class InstantialTest {

    private static Unsafe unsafe;
    static {
        try {
            Field f = Unsafe.class.getDeclaredField("theUnsafe");
            f.setAccessible(true);
            unsafe = (Unsafe) f.get(null);
        } catch (NoSuchFieldException e) {
            e.printStackTrace();
        } catch (IllegalAccessException e) {
            e.printStackTrace();
        }
    }
    
    public static void main(String[] args) throws Exception {
        // 1. æ„é€ æ–¹æ³•
        User user1 = new User();
        // 2. Classï¼Œé‡Œé¢å®é™…ä¹Ÿæ˜¯åå°„
        User user2 = User.class.newInstance();
        // 3. åå°„
        User user3 = User.class.getConstructor().newInstance();
        // 4. å…‹éš†
        User user4 = (User) user1.clone();
        // 5. ååºåˆ—åŒ–
        User user5 = unserialize(user1);
        // 6. Unsafe
        User user6 = (User) unsafe.allocateInstance(User.class);

        System.out.println(user1.age);
        System.out.println(user2.age);
        System.out.println(user3.age);
        System.out.println(user4.age);
        System.out.println(user5.age);
        System.out.println(user6.age);
    }

    private static User unserialize(User user1) throws Exception {
        ObjectOutputStream oos = new ObjectOutputStream(new FileOutputStream("D://object.txt"));
        oos.writeObject(user1);
        oos.close();

        ObjectInputStream ois = new ObjectInputStream(new FileInputStream("D://object.txt"));
        // ååºåˆ—åŒ–
        User user5 = (User) ois.readObject();
        ois.close();
        return user5;
    }

    static class User implements Cloneable, Serializable {
        private int age = 20;

        public User() {
            this.age = 10;
        }

        @Override
        protected Object clone() throws CloneNotSupportedException {
            return super.clone();
        }
    }
}
```

å…ˆä¸è¦æ€¥ç€å¾€ä¸‹çœ‹ï¼Œä½ çŒœçŒœä¸Šé¢å…­ç§æ–¹å¼æ‰“å°è¯­å¥è¾“å‡ºå„æ˜¯å¤šå°‘ï¼Ÿ

ä¸è¦çœ‹ï¼

ä¸è¦çœ‹ï¼

ä¸è¦çœ‹ï¼

æœ€åæ‰“å°çš„ç»“æœæ˜¯è¿™æ ·ï¼š

```java
10
10
10
10
10
0
```

æ„ä¸æ„å¤–ï¼ŸæƒŠä¸æƒŠå–œï¼Ÿ

æœ€åä¸€ç§é€šè¿‡Unsafeå®ä¾‹åŒ–çš„ç±»ï¼Œé‡Œé¢çš„ageçš„å€¼ç«Ÿç„¶æ˜¯0ï¼Œè€Œä¸æ˜¯10æˆ–è€…20ã€‚

è¿™æ˜¯å› ä¸ºè°ƒç”¨Unsafeçš„allocateInstance()æ–¹æ³•åªä¼šç»™å¯¹è±¡åˆ†é…å†…å­˜ï¼Œå¹¶ä¸ä¼šåˆå§‹åŒ–å¯¹è±¡ä¸­çš„å±æ€§ï¼Œæ‰€ä»¥intç±»å‹çš„é»˜è®¤å€¼å°±æ˜¯0ã€‚

---

æ¬¢è¿å…³æ³¨æˆ‘çš„å…¬ä¼—å·â€œå½¤å“¥è¯»æºç â€ï¼ŒæŸ¥çœ‹æ›´å¤šæºç ç³»åˆ—æ–‡ç« , ä¸å½¤å“¥ä¸€èµ·ç•…æ¸¸æºç çš„æµ·æ´‹ã€‚

![qrcode](https://gitee.com/alan-tang-tt/yuan/raw/master/æ­»ç£•%20javaé›†åˆç³»åˆ—/resource/qrcode_ss.jpg)
